# Day 13 – Recommendation System
## Оглавление
1. [Глава I](#глава-i) \
    1.1. [Преамбула](#преамбула)
2. [Глава II](#глава-ii) \
    2.1. [Общая инструкция](#общая-инструкция)
3. [Глава III](#глава-iii) \
    3.1. [Цели](#цели)
4. [Глава IV](#глава-iv) \
    4.1. [Задание](#задание)
5. [Глава V](#глава-v) \
    5.1. [Сдача работы и проверка](#сдача-работы-и-проверка)

## Глава I
### Преамбула
Рекомендательные системы - это программные инструменты, которые предлагают пользователям товары, услуги или контент 
на основе их предпочтений и поведения в прошлом. Они используют алгоритмы машинного обучения для анализа данных о 
пользователе и его взаимодействии с платформой, чтобы предложить наиболее релевантные и персонализированные рекомендации.

Рекомендательные системы используются в различных отраслях, включая электронную коммерцию, медиа, социальные сети и 
музыкальные сервисы. Они помогают платформам увеличивать продажи, улучшать удовлетворенность клиентов и повышать 
лояльность пользователей. Однако, они также могут вызывать определенные проблемы, такие как фильтрование информации 
и ограничение разнообразия предложений.

Рекомендательные системы нужны для улучшения пользовательского опыта, повышения удовлетворенности клиентов и увеличения 
продаж. Они помогают пользователям быстро найти то, что им нужно, не тратя время на поиск. Кроме того, 
рекомендательные системы позволяют платформам собирать данные о поведении пользователей и использовать 
их для улучшения качества продукта и разработки новых функций.

![netflix](misc/images/netflix.png)

Существует несколько типов рекомендательных систем, включая коллаборативную фильтрацию, контентную фильтрацию и 
гибридные системы. Коллаборативная фильтрация анализирует данные о предпочтениях пользователей и использует их 
для предложения товаров или услуг, которые могут заинтересовать пользователя. Контентная фильтрация использует анализ 
содержания товаров или услуг для предложения пользователю других товаров или услуг, которые могут быть интересны. 
Гибридные системы комбинируют оба подхода для улучшения качества рекомендаций.


## Глава II
### Общая инструкция

Методология Школы 21 может быть не похожа на тот образовательный опыт, который случался с тобой ранее. Её отличает высокий уровень автономии: у тебя есть задача, ты должен её выполнить. По большей части тебе нужно будет самому добывать знания для её решения. Второй важный момент — это peer-to-peer обучение. В образовательном процессе нет менторов и экспертов, перед которыми ты защищаешь свой результат. Ты это делаешь перед таким же учащимися, как и ты сам. У них есть чек-лист, который поможет им качественно выполнить приемку вашей работы.

Роль Школы 21 заключается в том, чтобы обеспечить через последовательность заданий и оптимальный уровень поддержки такую траекторию обучения, при которой ты не только освоишь hard skills, но и научишься самообучаться.

- Не доверяй слухам и предположениям о том, как должно быть оформлено ваше решение. Этот документ является единственным источником, к которому стоит обращаться по большинству вопросов;
- твое решение будет оцениваться другими учащимися;
- подлежат оцениванию только те файлы, которые ты выложил в GIT (ветка develop, папка src);
- в твоей папке не должно быть лишних файлов — только те, что были указаны в задании;
- не забывай, что у вас есть доступ к интернету и поисковым системам;
- обсуждение заданий можно вести и в Rocket.Chat;
- будь внимателен к примерам, указанным в этом документе — они могут иметь важные детали, которые не были оговорены другим способом;
- и да пребудет с тобой Сила!


## Глава III
### Цели
В этом проекте мы познакомимся с рекомендательными системами, алгоритмами для их построения и реализуем базовую систему 
рекомендаций фильмов, которая нам пригодится в следующем проекте.

## Глава IV
Для построения системы рекомендаций фильмов воспользуемся данными [TMDB 5000 Movie Dataset](https://www.kaggle.com/datasets/tmdb/tmdb-movie-metadata).

Датасет [tmdb_5000_credits.csv](https://files.sberdisk.ru/s/H9oRuXQt5mFz3T9) содержит следующие данные:
> movie_id — id каждого фильма\
cast — имена главных и второстепенных актеров\
crew — имена режиссера, редактора, композитора, сценариста и т. д.

Датасет [tmdb_5000_movies.csv](https://files.sberdisk.ru/s/te4QbzdxKgsFQXA) содержит следующие данные:
>id — id каждого фильма\
budget — бюджет фильма\
genre — жанр фильма: (боевик, комедия, триллер и т.д.)\
homepage — ссылка на домашнюю страницу фильма\
keywords — ключевые слова или теги, относящиеся к фильму\
original_language — язык фильма\
original_title — оригинальное название\
overview — описание сюжета\
popularity — популярность\
production_companies — киностудия\
production_countries — страна выпуска\
release_date — дата выпуска\
revenue — мировой доход\
runtime — время фильма в минутах\
status — статус фильма\
tagline — слоган\
title — название\
vote_average — средняя оценка\
vote_count — количество голосов

### Task 1
Объедини общие данные о фильмах [tmdb_5000_movies](https://files.sberdisk.ru/s/te4QbzdxKgsFQXA) и каст фильмов 
[tmdb_5000_credits](https://files.sberdisk.ru/s/H9oRuXQt5mFz3T9). Оставь в датасете только фильмы, которые вышли в "релиз".\
Выведи количество фильмов, оставшихся после фильтрации.

### Task 2
Самый наивный подход к рекомендации фильмов - рекомендовать фильмы с лучшими оценками пользователей. 
Фильмы, которые пользуются большей популярностью и признанием критиков, с большей вероятностью понравятся среднему 
зрителю. Для этого составим топ популярных фильмов, которые будем рекомендовать пользователям.

Для справедливой оценки фильмов возьмем текущую рейтинговую систему IMDB (weighted rating (WR)).
Имплементируй функцию `weighted_rating`. С её помощью рассчитай рейтинг для каждого фильма и сохрани его в колонку `simple_score`.\
Выведи топ-5 фильмов по получившемуся рейтингу.
> В качестве параметра $m$ выбери 95-й квантиль количества голосов.

### Task 3
Такой подход к рекомендациям очень наивен, так как не учитывает информацию о самом фильме (жанр, режиссер, описание, актеры и т.п). \
**Content Based Filtering** (Фильтрация на основе содержания) - тип рекомендательной системы, которая предлагает 
пользователям похожие элементы на основе конкретного элемента. Общая идея этих рекомендательных систем заключается 
в том, что если человеку понравился определенный товар, то ему понравится и похожий на него товар.

<center><img src="misc/images/content.png" alt= “” width="300" height="300"></center>

Реализуем алгоритм рекомендации на основе описания фильма. Для это требуется провести предобработку текста:
* Замени NaN в описании фильма на пустой символ `''`
* Удали все английские стоп-слова (используй параметр `stop_words` в `TfidfVectorizer`)
* Расcчитай [Tf-Idf](https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html) для описания фильма

Выведи размер получившейся матрицы Tf-Idf

> Для [TfidfVectorizer](https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html) используй параметры по умолчанию 

### Task 4
Теперь тебе необходимо вычислить показатель сходства между описаниями фильмов. Используем косинусное расстояние.
Но поскольку мы использовали векторизатор TF-IDF на предыдущем шаге, достаточно вычислить скалярное произведение, 
которое и даст оценку косинусного сходства. Рассчитать его можно через [linear_kernel](https://scikit-learn.org/stable/modules/generated/sklearn.metrics.pairwise.linear_kernel.html). 
Результат сохрани в переменную `cosine_sim`.

Выведи размер получившейся матрицы `cosine_sim`.

### Task 5
Напиши функцию `get_recommendations`. На вход она принимает:
* `movies_dataset` - датасет фильмов
* `title` - название фильма, для которого мы будем искать похожие
* `cosine_sim` - матрица расстояний между описаниями
* `top_k` - топ-k cхожих фильмов

Возвращает top_k названий фильмов, описание которых похоже на выбранный фильм.\
Выведи топ-5 фильмов для `title='Saving Private Ryan'` и их описания.

### Task 6
Еще один подход к построению рекомендательной системы - подход на основе сходства между пользователями. 
Этот подход называется **Collaborative Filtering** (Коллаборативная фильтрация). 

<center><img src="../misc/images/all.png" alt= “” width="600" height="400"></center>

Коллаборативная фильтрация - это тип рекомендательной системы, которая использует поведение и предпочтения похожих 
пользователей для рекомендации товаров или продуктов конкретному пользователю. Система собирает данные о прошлом 
поведении пользователей, такие как покупки, рейтинги и отзывы, и анализирует их для выявления закономерностей и 
сходства между пользователями. На основе этих закономерностей система рекомендует товары, которые понравились или 
были приобретены другими такими же пользователями в прошлом.

Для реализации Коллаборативной фильтрации нам потребуются оценки пользователей [ratings](https://files.sberdisk.ru/s/4Njwb9CfMbqVxEf).

>userId - id пользователя \
movieId - id фильма \
rating - оценка фильма (от 0 до 5)\
timestamp - время оценки

Воспользуйся библиотекой [surprise](https://surpriselib.com/) для обучения модели оценки рейтинга фильма 
[SVD](https://surprise.readthedocs.io/en/stable/matrix_factorization.html#surprise.prediction_algorithms.matrix_factorization.SVD).\
Выведи средние значения 'RMSE', 'MAE' на кросс-валидации с параметрами `cv=5`.

## Глава V
### Сдача работы и проверка

1. Сохрани решения в файл 13-recsys-assigment.ipynb.
2. Загрузи изменения на Git в ветку develop.

💡 [Нажми здесь](https://forms.gle/5Y8f6QXdRL6SxJrh6) **чтобы отправить обратную связь по проекту**. 
